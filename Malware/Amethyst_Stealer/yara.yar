rule AmethystStealer_4149b07d9fdc {
   meta:
      description = "Amethyst Stealer variant - specific sample"
      author = "IHATEAMETHYST"
      date = "2025-04-09"
      hash_sha256 = "4149b07d9fdcd04b34efa0a64e47a1b9581ff9d1f670ea552b7c93fb66199b5f"

   strings:
      $s1 = "(System.Globalization.DateTimeFormatFlags" fullword ascii
      $s2 = "'System.Globalization.DateTimeFormatInfo+" fullword ascii
      $s3 = "JIHfFloGFB" fullword ascii
      $ioc1 = "System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
      $ioc2 = "System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
      $ioc3 = "<assemblyIdentity version=\"1.0.0.0\" name=\"MyApplication.app\"/>"

   condition:
      uint16(0) == 0x5a4d and
      filesize > 3500KB and filesize < 4400KB and
      2 of ($ioc*) and
      2 of ($s*)
}
