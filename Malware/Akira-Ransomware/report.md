# Akira Ransomware Static Analysis Report

**Date:** 2025-08-19

---

## Executive Summary

*   **Identification:** PE32+ x64 (GUI) samples for Windows identified as Akira Ransomware.
*   **Direct Evidence:** The presence of the `.akira` file extension, the `akira_readme.txt` ransom note, and associated `.onion` URLs.
*   **Core Capabilities:** The malware includes functionalities for encryption (AES/RC4), obfuscation (stack strings), shadow copy deletion, system/file/process discovery, socket usage, hashing (SHA-256/MD5/FNV), and utilization of Restart Manager and WTS.

---

## Threat Context / Akira Group

Akira is a Ransomware-as-a-Service (RaaS) group that emerged in March 2023. Their operational model is based on double extortion: first, they steal large volumes of sensitive data from the victim's network, and subsequently, they encrypt the systems.

The group threatens to publish the stolen data on their dark web leak site if the ransom is not paid. This site features a retro aesthetic, mimicking a command-line terminal from the 1980s, which initially served as a distinct visual identifier.

While they initially focused on Windows systems, they quickly developed a Linux variant, enabling them to target a broader range of infrastructures, including VMware ESXi serversâ€”a common and high-value target.

In summary, Akira is a financially motivated criminal operation known for its double-extortion approach, rapid adaptation to target Linux systems, and its primary access vector through compromised VPN credentials.

---

## Attack Timeline (Kill Chain / Diamond Model)

### Phase 1: Initial Access

*   **Adversary:** The Akira group or one of its affiliates.
*   **Infrastructure:** The victim's own VPN infrastructure (e.g., Cisco ASA, Palo Alto).
*   **Capability (TTPs):**
    *   **T1133 - External Remote Services:** Exploiting known vulnerabilities in VPN services.
    *   **T1078 - Valid Accounts:** Using previously purchased or stolen VPN credentials, especially for accounts not protected by multi-factor authentication (MFA).
*   **Victim:** The corporate network is breached through a perimeter entry point.

### Phase 2: Discovery & Lateral Movement

Once inside, the attackers operate manually to map the network and expand their control.

*   **Adversary:** A human operator exploring the victim's network.
*   **Infrastructure:** Legitimate Windows tools (PowerShell, RDP), hacking tools (AdFind, PCHunter, LaZagne), and the victim's internal network.
*   **Capability (TTPs):**
    *   **Discovery:**
        *   **T1087 - Account Discovery:** Using tools like AdFind to map Active Directory.
        *   **T1057 - Process Discovery:** Using tools like PCHunter or Process Hacker to identify security processes.
        *   **T1018 - Remote System Discovery:** Scanning the network to find key servers (domain controllers, file servers, backup servers).
    *   **Credential Access:**
        *   **T1003 - Credential Dumping:** Using Mimikatz or LaZagne to steal passwords from memory.
    *   **Lateral Movement:**
        *   **T1021.002 - RDP:** Using the Remote Desktop Protocol to move between systems with stolen credentials.
        *   **T1021.001 - SMB/Admin Shares:** Using tools like PsExec to execute commands on other systems.
*   **Victim:** The attacker gains control over multiple systems, including domain administrator accounts.

### Phase 3: Data Exfiltration

Before encryption, valuable information is stolen to facilitate the double extortion.

*   **Adversary:** The operator packages and extracts the data.
*   **Infrastructure:** File transfer tools (FileZilla, WinSCP), cloud storage services, and the victim's internet connection.
*   **Capability (TTPs):**
    *   **T1041 - Exfiltration Over C2 Channel:** Data is extracted through already established communication channels.
    *   **T1567.002 - Exfiltration to Web Service:** Data is uploaded to services like MEGA or to attacker-controlled servers.
*   **Victim:** Suffers a massive data breach. Confidential information (financial, customer, intellectual property) is now in the hands of the attackers.

### Phase 4: Impact

This is the final and most destructive phase, where the ransomware is deployed.

*   **Adversary:** The operator executes the ransomware deployment script.
*   **Infrastructure:** PowerShell or batch scripts, and the Akira ransomware executable itself (Windows or Linux/ESXi version).
*   **Capability (TTPs):**
    *   **T1562.001 - Impair Defenses:** Commands are run to disable antivirus or Windows firewalls.
    *   **T1490 - Inhibit System Recovery:** `vssadmin.exe` is used to delete Shadow Copies, preventing easy file restoration.
    *   **T1486 - Data Encrypted for Impact:** The `akira.exe` payload (or similar) is executed on all target servers and workstations, encrypting files and appending the `.akira` extension.

---

### Artifacts and Hashes

| Sample | SHA-256 | MD5 |
| :--- | :--- | :--- |
| **Sample 1** | `06c2a137c31aae5d02b4d7df61ffd31f1af9a9e59978f15b3f7265cc751bff1f` | `aa88621587a40bf353cc07a965e00ee2` |
| **Sample 2** | `aa1f4e8e7066b57f594ebed05e931932277c35495ba407f1f97675c6ce4be5cc` | `30c74ff0e03d41dcf43257fe54467a02` |
| **Sample 3** | `fc2b499708b2d20545c140906b0484546c8b3ff21341b8a5acd18f2063fa2bb5` | `17053bba693646bfff25c1a8317f8f16` |

---

### Indicators of Compromise (IOCs)

| Indicator Type | Value |
| :--- | :--- |
| **File Extension** | `.akira` (internal strings also show `.arika`) |
| **Ransom Note** | `akira_readme.txt` (present as a global symbol in the binary) |
| **Onion URL (Blog)** | `akiral2iz6a7qgd3ayp3l6yub7xx2uep76idk3u2kollpj5z3z636bad.onion` |
| **Onion URL (Chat)** | `akiralkzxzq2dsrzsrvbr2xgbbu2wgsmxryd4csgfameg52n7efvr2id.onion` |
| **Note Access Codes** | Examples: `2050-SI-JSTG-PHIL`, `9130-XK-YNZA-JTEW`, `5231-EN-UWIC-IZUX` |
| **Shadow Copy Deletion** | `powershell.exe -Command "Get-WmiObject Win32_Shadowcopy | Remove-WmiObject"` |
| **Log Clearing** | `Get-WinEvent -ListLog * | ... Clear-Log($_.LogName)` |
| **Excluded Directories**| `Windows`, `System Volume Information`, `ProgramData`, `$Recycle.Bin`, `Trend Micro` |
| **Targeted File Types**| Databases (`.mdb`, `.mdf`, `.db`, `.sqlite`), Virtual Machines (`.vhd`/`.vhdx`, `.vmdk`, `.qcow2`, `.iso`) |

---

### PE Metadata

*   **Format:** PE32+ executable (GUI) x86-64.
*   **Imported DLLs:** `KERNEL32.dll`, `SHELL32.dll`, `ole32.dll`, `OLEAUT32.dll`, `WS2_32.dll`, `SHLWAPI.dll`, `MPR.dll`, `WTSAPI32.dll`, `RstrtMgr.dll`.

---

### Techniques and Capabilities (MITRE ATT&CK)

| Tactic | Technique ID | Technique Name | Description/Context |
| :--- | :--- | :--- | :--- |
| **Initial Access** | T1078 | Valid Accounts | Akira often leverages compromised credentials, especially for VPNs without MFA. |
| | T1133 | External Remote Services | Observed exploiting vulnerabilities in VPN services, such as Cisco, to gain network access. |
| **Execution** | T1059.003 | Windows Command Shell | Uses the command line to execute malicious commands and scripts. |
| | T1059.001 | PowerShell | Employs PowerShell for various tasks, including downloading tools and manipulating files. |
| **Persistence** | T1078 | Valid Accounts | Uses stolen credentials to maintain access and move laterally. |
| **Privilege Escalation** | T1078 | Valid Accounts | Seeks and uses accounts with administrative privileges to gain greater control. |
| **Defense Evasion** | T1027 | Obfuscated Files or Information | The ransomware code is often obfuscated to hinder analysis and antivirus detection. |
| | T1562.001 | Impair Defenses | Attempts to disable security products and antivirus on infected systems before encryption. |
| **Credential Access** | T1003 | OS Credential Dumping: LSASS Memory | Extracts credentials from the LSASS process to access more accounts and systems. |
| **Discovery** | T1087.002 | Account Discovery: Domain Account | Enumerates domain accounts to identify users and administrators. |
| | T1082 | System Information Discovery | Gathers information about infected systems, such as hostname and OS version. |
| | T1016 | System Network Configuration Discovery | Analyzes network configuration to understand topology for lateral movement. |
| **Lateral Movement** | T1021.002 | Remote Services: Remote Desktop Protocol | Uses RDP to move between systems within the compromised network. |
| **Impact** | T1486 | Data Encrypted for Impact | The primary technique, encrypting victim files and demanding a ransom for recovery. |
| | T1490 | Inhibit System Recovery | Deletes Shadow Copies to prevent victims from restoring files without paying. |

---

### Note on Command and Control (C2)

The static Akira payload does not implement C2 communication. This is because Akira is a human-operated ransomware. The attackers maintain access and control of the network using post-exploitation tools (Cobalt Strike, Metasploit, RDP, PsExec, PowerShell, etc.) before deploying the binary.

The ransomware itself only fulfills the Impact phase (encryption). Therefore, the Command & Control activity corresponds to the infrastructure and tools used in the preceding phases of the intrusion, not the final executable.

---

### Key Functions Analyzed

*   **FUN_140043e80:** Writes the `akira_readme.txt` ransom note.
*   **FUN_1400434c0:** Classifies paths/drives (local vs. network, exclusions).
*   **FUN_140078cc0:** Uses Restart Manager to unlock files for encryption.
*   **FUN_140078ac0:** Enumerates processes (WTS).
*   **FUN_14007e6a0:** Discovers drives.
*   **FUN_140001c10 / FUN_1400036c0:** Decodes strings (stack strings).

---

### Assessment

*   **Conclusion:** High probability of Akira Ransomware.
*   **Evidence:** The evidence is compelling, including the `.akira` extension, the embedded ransom note, contact URLs, shadow copy deletion, and the use of Restart Manager.
*   **Implementation:** The malware uses a proprietary encryption implementation, with internal error messages indicating a custom pipeline involving AES/RC4, SHA-256, and MD5.

---

### Recommendations

*   Do not execute outside of a controlled, sandboxed environment.
*   Block and/or monitor the associated `.onion` URLs.
*   Detect suspicious commands related to shadow copy deletion and log clearing.
*   Implement YARA rules based on combinations of strings and imported DLLs (e.g., `RstrtMgr.dll` + `WTSAPI32.dll` + `.akira`).
*   Add the identified file hashes to EDR/SIEM blocklists.

---

## Practical Defensive Indicators

### 1. Perimeter and Network Access

Most Akira attacks start here. Strengthening the perimeter is the best defense.

*   **Mandatory MFA (Multi-Factor Authentication):**
    *   **Defensive Indicator:** Any remote access service (VPN, RDP, Citrix) NOT protected by MFA is a critical vulnerability.
    *   **Action:** Implement MFA on ALL external access points without exception. This is the single most effective measure against the use of stolen credentials.
*   **Network Device Patching:**
    *   **Defensive Indicator:** Outdated firmware versions on your VPNs (Cisco, Palo Alto, Fortinet, etc.) and other perimeter devices.
    *   **Action:** Maintain an inventory of internet-facing devices and apply security patches on a priority basis.
*   **Network Traffic Filtering:**
    *   **Defensive Indicator:** Outbound (egress) network traffic to unknown or unauthorized cloud services (MEGA, pCloud, etc.) or the use of protocols like FTP/SFTP from workstations.
    *   **Action:** Implement firewall policies to block or, at a minimum, alert on large volumes of outbound data to unusual destinations.

### 2. Endpoints (Servers and Workstations)

This is where attackers execute their tools and the ransomware itself.

*   **Command Monitoring:**
    *   **Defensive Indicator:** The execution of specific commands that are direct precursors to an attack.
    *   **Action:** Create detection and alerting rules in your EDR/SIEM for:
        *   Use of `vssadmin.exe delete shadows` or `wbadmin delete catalog`.
        *   Use of `bcdedit.exe` to modify boot policies (`bootstatuspolicy`, `recoveryenabled`).
        *   PowerShell calls to `Get-WmiObject Win32_Shadowcopy` followed by a `.Delete()` method.
*   **Blocking Hacking Tools:**
    *   **Defensive Indicator:** The presence or execution of files like `Mimikatz.exe`, `LaZagne.exe`, `AdFind.exe`, `PCHunter.exe`, `rclone.exe`, or `AnyDesk.exe` (if not a corporate tool).
    *   **Action:** Use AppLocker policies or your EDR to block the execution of these tools by their hash or filename.
*   **PowerShell Hardening:**
    *   **Defensive Indicator:** Permissive PowerShell execution policies (`Unrestricted` or `Bypass`).
    *   **Action:** Enable PowerShell's "Constrained Language Mode" and activate "Script Block Logging" and transcription. This will log nearly everything attackers do with PowerShell, facilitating detection.

### 3. Identity and Privilege Management

Credential abuse is fundamental to Akira's lateral movement.

*   **Principle of Least Privilege:**
    *   **Defensive Indicator:** User accounts (especially domain admins) being used for daily activities like web browsing or checking email.
    *   **Action:** Separate accounts. Administrators should have a standard account for daily use and a privileged account (e.g., `admin-user`) used only for administrative tasks.
*   **Credential Dumping Detection:**
    *   **Defensive Indicator:** An unauthorized process (like `powershell.exe` or an unknown executable) accessing the memory of the `LSASS.exe` process.
    *   **Action:** Configure your EDR or Microsoft Defender for Endpoint to block and alert on access to LSASS.

### 4. Resilience and Recovery

If all else fails, this is what will save you.

*   **Immutable and Offline Backups:**
    *   **Defensive Indicator:** All of your backups are online and accessible from the primary network.
    *   **Action:** Follow the 3-2-1 rule: **3** copies of your data, on **2** different media, with at least **1** copy offline (or immutable in the cloud). The ransomware cannot encrypt what it cannot reach.
*   **Restoration Testing:**
    *   **Defensive Indicator:** You have never tested restoring your backups in a disaster scenario.
    *   **Action:** Conduct periodic restoration tests to ensure the backups are functional and that your team knows how to use them under pressure.

---

## Appendices

*   **Example Timestamp:** 19-Mar-2025 13:53:17.
*   **Key Addresses in Decompiler (Ghidra):**
    *   **Note Creation:** lines 20833-20937.
    *   **Disk Classification:** 21261-21313.
    *   **Restart Manager:** 69309-69580.
    *   **Process Enumeration:** 69343-69427.
