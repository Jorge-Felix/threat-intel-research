import "pe"

rule MAL_PromptLock_Disk_Artifact_Strings
{
    meta:
        description = "Detects the PromptLock malware by identifying strings of artifact filenames that it creates on disk. These strings are embedded within the malware binary."
        author = "detections.ai"
        date = "2025-08-29"
        version = 1
        reference = "https://raw.githubusercontent.com/Jorge-Felix/threat-intel-research/refs/heads/main/Malware/prompt-lock/report.md"
        hash = "1458b6dc98a878f237bfb3c3f354ea6e12d76e340cefe55d6a1c9c7eb64c9aee"
        tags = "FILE, RANSOMWARE, PROMPTLOCK, GOLANG"
        mitre_attack = "T1083"
        malware_family = "PromptLock"
        malware_type = "Ransomware"

    strings:
        // Filenames of artifacts created by PromptLock, found as strings in the binary.
        $artifact_1 = "target_file_list.log" ascii wide
        $artifact_2 = "target_file_info.log" ascii wide
        $artifact_3 = "target_file_summary.log" ascii wide
        $artifact_4 = "sysinfo_summary.txt" ascii wide
        $artifact_5 = "payloads.txt" ascii wide
        $artifact_6 = "scan.log" ascii wide
        $artifact_7 = "decryptor.txt" ascii wide
        $artifact_8 = "debug_conversations" ascii wide // Also mentioned in the report

    condition:
        // Target PE files, likely Go binaries under 15MB.
        pe.is_pe
        and filesize < 15MB
        // Requiring 3 or more artifact names significantly increases confidence.
        // Some filenames like 'scan.log' or 'payloads.txt' can be generic, so a threshold helps avoid FPs.
        and 3 of ($artifact_*)
}
